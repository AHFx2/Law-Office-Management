<div class="content">

    <app-page-header-component title="القضايا المستلمة"></app-page-header-component>
    <div class="section">
        <h2>المحاكم</h2>
        <div class="row">
            @for (court of courts; track court.courtTypeId; let firstItem = $first) {
            <button (click)="updateTableData(court.courtTypeId, selectedYear)" (click)="onCourtChange(court)"
                class="btn col-sm-12 col-lg-1 " [ngClass]="{'bg-sub': activeButton === court.code}"
                (click)="setActiveButton(court.code)">
                {{ court.code }}
            </button>
            }
        </div>

    </div>
    <div class="section">
        @if (casesList?.items?.length) {
        <div class="row">
            <h3 class="col-md-10">القضايا {{selectedYear.value}}</h3>
            <select (change)="updateTableData(selectedCourt.courtTypeId, selectedYear.value)" [(ngModel)]="selectedYear"
                #selectedYear class="form-select col">
                @for (year of selectedCourt.years; track year; let firstItem = $first) {
                <option (focus)="yearChanged(year)" [value]="year" [selected]="firstItem">{{year}}</option>
                }
            </select>
        </div>


        <div class=" table-responsive">

            <table mat-table [dataSource]="casesList.items" class="mat-elevation-z8 table">

                <ng-container [matColumnDef]="displayedColumns[0]">
                    <th mat-header-cell *matHeaderCellDef> رقم الملف</th>
                    <td mat-cell *matCellDef="let element"> {{element.fileNumber}} </td>
                </ng-container>

                <ng-container [matColumnDef]="displayedColumns[1]">
                    <th mat-header-cell *matHeaderCellDef> اسم العميل </th>
                    <td mat-cell *matCellDef="let element"> {{element.clientName}} </td>
                </ng-container>

                <ng-container [matColumnDef]="displayedColumns[2]">
                    <th mat-header-cell *matHeaderCellDef> رقم القضية </th>
                    <td mat-cell *matCellDef="let element"> {{element.caseNumber}} </td>
                </ng-container>

                <ng-container [matColumnDef]="displayedColumns[3]">
                    <th mat-header-cell *matHeaderCellDef> حالة القضية </th>
                    <td mat-cell *matCellDef="let element"> <span appCaseStatus>{{element.status}}</span></td>
                </ng-container>


                <ng-container [matColumnDef]="displayedColumns[4]">
                    <th mat-header-cell *matHeaderCellDef> التفاصيل </th>
                    <td mat-cell *matCellDef="let element"> <a [routerLink]="['../case-details', element.caseId]"
                            class="btn bg-main">التفاصيل</a> </td>
                </ng-container>

                <tr mat-header-row *matHeaderRowDef="displayedColumns"></tr>
                <tr mat-row *matRowDef="let row; columns: displayedColumns;"></tr>
            </table>
        </div>

        } @else {
        <h2>لا توجد قضايا</h2>
        }


    </div>
</div>