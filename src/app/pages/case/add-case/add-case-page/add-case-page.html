<app-page-header-component title="ุฅุถุงูุฉ ูุถูุฉ ุฌุฏูุฏุฉ"
    description="ุฃุฏุฎู ุจูุงูุงุช ุงููุถูุฉ ูุงูุนููู"></app-page-header-component>
<section class="section">
    <h3>ุงูุจุญุซ ุนู ุงูุนููู</h3>
    <div class="search-box">
        <form #searchForm="ngForm" (ngSubmit)="search(natId)">
            <div class="row g-3">
                <div class="col-md-10">
                    <input type="text" name="natid" [(ngModel)]="natId" #natIdModel="ngModel"
                        [class.border-error]="(natIdModel.invalid && natIdModel.touched) || showErrors" required
                        maxlength="10" pattern="^\d{10}$" placeholder="ุฃุฏุฎู ุฑูู ุงููููุฉ ููุจุญุซ" class="form-control" />
                </div>
                <div class="col-md-2">
                    <input type="submit" value="ุจุญุซ" [disabled]="searchForm.invalid"
                        [class.disabled]="searchForm.invalid" class="btn bg-sub searchbtn form-control" />
                </div>
            </div>
            <div *ngIf="natIdModel.touched || showErrors" class="errors" animate.enter="error-animation">
                <p *ngIf="natIdModel.errors?.['required']">ูุฌุจ ุฅุฏุฎุงู ุฑูู ุงููููุฉ</p>
                <p *ngIf="natIdModel.errors?.['pattern']">ุฑูู ุงููููุฉ ูุฌุจ ุฃู ูุชููู ูู 10 ุฎุงูุงุช</p>
            </div>
        </form>
        @if ((addCaseForm.value.existingClients?.length) || (addCaseForm.value.newClients?.length)) {
        <div class="parties-container">
            <p>ุฃุทุฑุงู ุงููุถูุฉ ุงููุฎุชุงุฑุฉ:</p>
            <div>
                @for(client of addCaseForm.value.existingClients; track client.natId) {
                <div class="parties client-id  myrow">
                    <p class="flex">ุฑูู ุงููููุฉ: {{client.natId}}</p>
                    <a class="btn-del" (click)="deleteExistingClient(client.natId!)"><i
                            class="fa-solid fa-xmark"></i></a>
                </div>
                }

                @for(client of addCaseForm.value.newClients; track client.person?.natId) {
                <div class="parties client-id  myrow">
                    <p class="flex">ุฑูู ุงููููุฉ: {{client?.person?.natId}}</p>
                    <a class="btn-del" (click)="deleteNewClient(client.person?.natId!)"><i
                            class="fa-solid fa-xmark"></i></a>
                </div>
                }
            </div>
        </div>
        }
        <p class="txt">๐ก ุฅุฐุง ูู ูุชู ุงูุนุซูุฑ ุนูู ุงูุนูููุ ุณุชูุชุญ ูุงูุฐุฉ ูุฅุถุงูุฉ ุนููู ุฌุฏูุฏ</p>
    </div>
</section>
<form [formGroup]="addCaseForm">
    <section formGroupName="case" class="section">
        <h3>ุจูุงูุงุช ุงููุถูุฉ</h3>
        <div class="row g-3">
            <div class="col-md-6">
                <label class="form-label">ููุถูุน ุงููุถูุฉ</label>
                <input type="text" formControlName="subject" placeholder="ุฃุฏุฎู ููุถูุน ุงููุถูุฉ"
                    [class.border-error]="(addCaseForm.controls.case.controls.subject.touched && addCaseForm.controls.case.controls.subject.invalid) || showErrors"
                    class="form-control" />
                <div class="errors" *ngIf="addCaseForm?.controls?.case?.controls?.subject?.touched"
                    animate.enter="error-animation">
                    <p *ngIf="addCaseForm.controls?.case?.controls?.subject?.errors?.['required']">ูุฐุง ุงูุญูู ูุทููุจ</p>
                    <p *ngIf="addCaseForm.controls?.case?.controls?.subject?.errors?.['minlength']">ูุฌุจ ุฃู ูููู ุนูู
                        ุงูุฃูู 3 ุฃุญุฑู</p>
                </div>
            </div>
            <div class="col-md-6">
                <label class="form-label">ุงุทุฑุงู ุงูุฏุนูู</label>
                <select formControlName="partiesToTheCase" class="form-control">
                    <option value="1">ูุฏุนู</option>
                    <option value="2">ูุฏุนู ุนููู</option>
                </select>
            </div>
            <div class="col-md-6">
                <label class="form-label">ุงูููุช ุงููุชููุน ููุฏุฑุงุณุฉ</label>
                <input type="date" formControlName="estimatedTime"
                    [class.border-error]="(addCaseForm.controls.case.controls.estimatedTime.touched && addCaseForm.controls.case.controls.estimatedTime.invalid) || showErrors"
                    class="form-control" />
                <div *ngIf="addCaseForm.controls?.case?.controls?.estimatedTime?.touched || showErrors" class="errors"
                    animate.enter="error-animation">
                    <p *ngIf="addCaseForm.controls?.case?.controls?.estimatedTime?.errors?.['required']">ูุฑุฌู ุชุญุฏูุฏ
                        ุงูุชุงุฑูุฎ</p>
                    <p *ngIf="addCaseForm.controls?.case?.controls?.estimatedTime?.errors?.['pastDate']">ุงุฏุฎู ููุช ูู
                        ุงูุญุงุถุฑ
                        ุงู ุงููุณุชูุจู</p>
                </div>
            </div>
            <div class="col-md-6">
                <label class="form-label">ููุน ุงููุญููุฉ</label>
                <select formControlName="courtType" class="form-select">
                    <option *ngFor="let court of courts" [value]="court.courtTypeId">{{court.name}}</option>
                </select>
            </div>
            <div class="col-md-6">
                <label class="form-label">ุงูููุธู ุงููููู ุนูู ุงููุถูุฉ</label>
                <select formControlName="assignedOfficer" class="form-select">
                    <option *ngFor="let employeeName of employeeNames" [value]="employeeName.id">{{employeeName.name}}
                    </option>
                </select>
            </div>
            <div class="col-md-6">
                <label class="form-label">ุฑูู ุงููุถูุฉ</label>
                <input type="text" formControlName="caseNumber" placeholder="ุฃุฏุฎู ุฑูู ุงููุถูุฉ"
                    [class.border-error]="(addCaseForm.controls.case.controls.caseNumber.touched && addCaseForm.controls.case.controls.caseNumber.invalid) || showErrors"
                    class="form-control" />
                <div class=" errors" *ngIf="addCaseForm.controls?.case?.controls?.caseNumber?.touched || showErrors"
                    animate.enter="error-animation">
                    <p *ngIf="addCaseForm.controls?.case?.controls?.caseNumber?.errors?.['required']">ูุฐุง ุงูุญูู ูุทููุจ
                    </p>
                </div>
            </div>
            <div class="col-12 lawyer-opnion">
                <label class="form-label">ุฑุฃู ุงููุญุงูู</label>
                <textarea formControlName="lawyerOpinion"
                    [class.border-error]="(addCaseForm.controls.case.controls.lawyerOpinion.touched && addCaseForm.controls.case.controls.lawyerOpinion.invalid) || showErrors"
                    placeholder="ุฑุฃู ุงููุญุงูู" class="form-control"></textarea>
                <div class=" errors" *ngIf="addCaseForm.controls?.case?.controls?.lawyerOpinion?.touched || showErrors"
                    animate.enter="error-animation">
                    <p *ngIf="addCaseForm.controls?.case?.controls?.lawyerOpinion?.errors?.['required']">ูุฐุง ุงูุญูู ูุทููุจ
                    </p>
                    <p *ngIf="addCaseForm.controls?.case?.controls?.lawyerOpinion?.errors?.['minlength']">ูุฌุจ ุฃู ูุญุชูู
                        ุนูู 10 ุฃุญุฑู ุนูู ุงูุฃูู</p>
                </div>
            </div>
        </div>
    </section>
    <div class="btn-group" role="group" aria-label="Buttons Action group">
        <button type="submit" (click)="submit(false)" class="btn bg-sub">ุฅุฑุณุงู ุงูููุงููุฉ</button>
        <button type="submit" (click)="submit(true)" class="btn bg-accent">ุญูุธ ููุณูุฏุฉ</button>
    </div>
</form>